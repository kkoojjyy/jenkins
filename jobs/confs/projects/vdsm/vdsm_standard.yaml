- vdsm_standard_common:
    name: 'vdsm_standard_common'
    vdsm_standard--key: &vdsm_standard_common
      project:
        - vdsm
      trigger: 'on-change'
      version:
        - master:
            branch: master
        - 4.1:
            branch: ovirt-4.1
        - 4.0:
            branch: ovirt-4.0
        - 3.6:
            branch: ovirt-3.6
      distro:
        - el7
        - fc24
        - fc25
        - fc26
        - fc27
        - fcraw
      exclude:
        - version: master
          distro: fc25
        - version: master
          distro: fc24
        - version: 4.1
          distro: fcraw
        - version: 4.1
          distro: fc27
        - version: 4.1
          distro: fc26
        - version: 4.1
          distro: fc25
        - version: 4.0
          distro: fcraw
        - version: 4.0
          distro: fc27
        - version: 4.0
          distro: fc26
        - version: 4.0
          distro: fc25
        - version: 4.0
          distro: fc24
        - version: 3.6
          distro: fcraw
        - version: 3.6
          distro: fc27
        - version: 3.6
          distro: fc26
        - version: 3.6
          distro: fc25
        - version: 3.6
          distro: fc24
      jobs:
        - '{project}_{version}_{stage}-{distro}-{arch}'

- project: &vdsm_build_artifacts_common_x86_64
    <<: *vdsm_standard_common
    name: vdsm_build-artifacts_x86_64
    notification-url: 'https://ovirt-ovirt-engine.getbadges.io/api/app/webhook/66f43bb2-6b98-4aab-8d1a-7acca6704dab'
    stage: build-artifacts
    version:
      - master:
          branch: master
          repoversion: master
      - 4.1:
          branch: ovirt-4.1
          repoversion: 4.1
      - 4.0:
          branch: ovirt-4.0
          repoversion: 4.0
      - 3.6:
          branch: ovirt-3.6
          repoversion: 3.6
    arch: x86_64
    jobs:
      - '{project}_{version}_build-artifacts-{distro}-{arch}'
      - '{project}_{version}_{stage}-on-demand-{distro}-{arch}'

- project:
    <<: *vdsm_build_artifacts_common_x86_64
    name: vdsm_build-artifacts-manual_x86_64
    stage: build-artifacts-manual
    version:
      - master:
          branch: master
          repoversion: master
      - 4.1:
          branch: ovirt-4.1
          repoversion: 4.1
      - 4.0:
          branch: ovirt-4.0
          repoversion: 4.0
    trigger: manual
    jobs:
      - '{project}_{version}_build-artifacts-manual-{distro}-{arch}'

- project:
    <<: *vdsm_standard_common
    name: vdsm_build-artifacts-manual-any
    stage: build-artifacts-manual
    version:
      - '4.0'
      - '4.1'
      - 'master'
    jobs:
      - '{project}_any_build-artifacts-manual'

- project:
    <<: *vdsm_standard_common
    name: vdsm_build-artifacts_altarch
    stage: build-artifacts
    version:
      - master:
          branch: master
      - 4.1:
          branch: ovirt-4.1
    distro:
      - el7
      - fc27
    arch:
      - ppc64le:
          node-filter: ppc64le
      - s390x:
          node-filter: s390x
    exclude:
      - { version: 4.1, arch: s390x, }
      - {               arch: s390x,   distro: el7, }
      - {               arch: ppc64le, distro: fc27, }
    jobs:
      - '{project}_{version}_build-artifacts-{distro}-{arch}'

- project:
    <<: *vdsm_standard_common
    name: vdsm_check-patch
    arch: x86_64
    stage: check-patch

- project:
    <<: *vdsm_standard_common
    name: vdsm_check-merged
    distro: el7
    arch: x86_64
    stage: check-merged
